const urlText=window.location.href;let url=new URL(urlText);const productId=url.searchParams.get("id");console.log("id du produit qui a été cliqué sur la page d'accueil : ",productId);const intemImg=document.getElementsByClassName("item__img")[0],image=document.createElement("img");intemImg.appendChild(image);const title=document.getElementById("title"),price=document.getElementById("price"),description=document.getElementById("description"),colorSelect=document.getElementById("colors");let addColors=colors=>{for(let i=0;i<colors.length;i++){let color=document.createElement("option");colorSelect.appendChild(color),color.setAttribute("value",colors[i]),color.textContent=colors[i]}};async function addProductInfo(){let product=await getProductById(productId);console.log("Information du produit dont on a récupérer l'id",product),image.setAttribute("src",product.imageUrl),image.setAttribute("alt",product.altTxt),title.textContent=product.name,price.textContent=" "+product.price+" ",description.textContent=product.description,addColors(product.colors)}addProductInfo();let cartToModify=buildCartFromStorage(),quantityElement=document.getElementById("quantity");class CartItem{constructor(id,quantity,color){this.id=id,this.quantity=quantity,this.color=color}}let getItem=()=>{const itemQuantity=parseInt(quantityElement.value);let itemToGet=new CartItem(productId,itemQuantity,colorSelect.value);return console.log("L'article créé est le suivant : ",itemToGet),itemToGet},getItemInfoOnCart=(cart,item)=>{let itemInfoOnCart={cartIndex:0,isIdOnCart:!1,isItemOnCart:!1},loopCount=0;for(;!1===itemInfoOnCart.isItemOnCart&&loopCount<cart.length;)cart[loopCount].id===item.id&&cart[loopCount].color===item.color?(itemInfoOnCart.cartIndex=loopCount,itemInfoOnCart.isItemOnCart=!0):cart[loopCount].id===item.id&&(itemInfoOnCart.isIdOnCart=!0,itemInfoOnCart.cartIndex=loopCount),loopCount++;return console.log("Info de l'article dans le panier",itemInfoOnCart),itemInfoOnCart};function addItemToCart(cart,item){const itemOnCart=getItemInfoOnCart(cart,item);if(itemOnCart.isItemOnCart)cart[itemOnCart.cartIndex].quantity+=item.quantity;else if(itemOnCart.isIdOnCart){const indexToTarget=itemOnCart.cartIndex;cart.splice(indexToTarget,0,item)}else cart.push(item);return console.log("Panier après modification ou ajout",cart),cart}const addToCart=document.getElementById("addToCart");addToCart.addEventListener("click",(function(){if(""==colorSelect.value||0==quantity.value)alert("Sélectionnez une couleur et un nombre d'article supérieur à 0");else{let itemToAdd=getItem(),cartModified=addItemToCart(cartToModify,itemToAdd);storeCart(cartModified),cartToModify=cartModified,confirm("Souhaitez vous être redirigé vers la page panier ?")&&(window.location.href="cart.html")}}));